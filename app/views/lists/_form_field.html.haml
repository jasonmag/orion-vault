
%div{ "data-controller" => "effective-date" }
  .grid.grid-cols-1.gap-6
    .space-y-2
      %label.block.text-sm.font-semibold.text-gray-700{ for: "list_name" }
        Name
        %span.text-red-500 *
      %input.w-full.rounded-md.border.border-gray-300.px-3.py-2.text-gray-900.shadow-sm.focus:border-gray-900.focus:ring-1.focus:ring-gray-900{ type: "text", name: "list[name]", id: "list_name", value: @list.name, placeholder: "Rent, internet, memberships" }

    .space-y-2
      %label.block.text-sm.font-semibold.text-gray-700{ for: "list_price" }
        Price
        %span.text-red-500 *
      %input.w-full.rounded-md.border.border-gray-300.px-3.py-2.text-gray-900.shadow-sm.focus:border-gray-900.focus:ring-1.focus:ring-gray-900{ type: "number", name: "list[price]", id: "list_price", step: "0.01", value: @list.price, placeholder: "0.00" }

    .space-y-2
      %label.block.text-sm.font-semibold.text-gray-700{ for: "list_description" } Description
      %textarea.w-full.rounded-md.border.border-gray-300.px-3.py-2.text-gray-900.shadow-sm.focus:border-gray-900.focus:ring-1.focus:ring-gray-900{ name: "list[description]", id: "list_description", rows: "3" }= @list.description

    .grid.grid-cols-1.gap-6.sm:grid-cols-2
      .space-y-2
        %label.block.text-sm.font-semibold.text-gray-700{ for: "list_effective_start_date" }
          Effective start date
          %span.text-red-500 *
        %input.w-full.rounded-md.border.border-gray-300.px-3.py-2.text-gray-900.shadow-sm.focus:border-gray-900.focus:ring-1.focus:ring-gray-900{ type: "date", name: "list[effective_start_date]", id: "list_effective_start_date", value: @list.effective_start_date || Date.today, data: { effective_date_target: "startDate", action: "change->effective-date#updateStartDate" } }

      .space-y-2
        %label.block.text-sm.font-semibold.text-gray-700{ for: "list_effective_end_date" } Effective end date
        %input.w-full.rounded-md.border.border-gray-300.px-3.py-2.text-gray-900.shadow-sm.focus:border-gray-900.focus:ring-1.focus:ring-gray-900{ type: "date", name: "list[effective_end_date]", id: "list_effective_end_date", value: @list.effective_end_date, data: { effective_date_target: "endDate" } }

  .payment_schedule_fields.mt-8
    - @list.payment_schedule ||= PaymentSchedule.new
    %fieldset
      %h2.text-lg.font-semibold.text-gray-900.mb-4 Payment schedule
      .space-y-4
        .space-y-2
          %label.block.text-sm.font-semibold.text-gray-700{ for: "payment_schedule_frequency" }
            Frequency
            %span.text-red-500 *
          %select.w-full.rounded-md.border.border-gray-300.bg-white.px-3.py-2.text-gray-900.shadow-sm.focus:border-gray-900.focus:ring-1.focus:ring-gray-900{ name: "list[payment_schedule_attributes][frequency]", id: "payment_schedule_frequency", data: { action: "change->effective-date#setFrequency" } }
            %option{ value: "", selected: @list.payment_schedule.frequency.blank? } Select frequency
            - PaymentSchedule::FREQUENCIES.each do |frequency|
              %option{ value: frequency, selected: @list.payment_schedule.frequency == frequency }= PaymentSchedule::FREQUENCIES.find { |f| f == frequency }.capitalize.gsub('_', ' ')

        .space-y-2{ style: "display:none;", data: { effective_date_target: "dayOfMonthField" } }
          %label.block.text-sm.font-semibold.text-gray-700{ for: "payment_schedule_day_of_month" }
            Day of month (1-15 for semi-monthly)
            %span.text-red-500 *
          %select.w-full.rounded-md.border.border-gray-300.bg-white.px-3.py-2.text-gray-900.shadow-sm.focus:border-gray-900.focus:ring-1.focus:ring-gray-900{ name: "list[payment_schedule_attributes][day_of_month]", id: "payment_schedule_day_of_month" }
            %option{ value: "", selected: @list.payment_schedule.day_of_month.blank? } Select day
            - (1..31).each do |day|
              %option{ value: day, selected: @list.payment_schedule.day_of_month == day }= day.ordinalize

        .space-y-2{ style: "display:none;", data: { effective_date_target: "dayOfWeekField" } }
          %label.block.text-sm.font-semibold.text-gray-700{ for: "payment_schedule_day_of_week" }
            Day of week (for weekly/bi-weekly)
            %span.text-red-500 *
          %select.w-full.rounded-md.border.border-gray-300.bg-white.px-3.py-2.text-gray-900.shadow-sm.focus:border-gray-900.focus:ring-1.focus:ring-gray-900{ name: "list[payment_schedule_attributes][day_of_week]", id: "payment_schedule_day_of_week" }
            %option{ value: "", selected: @list.payment_schedule.day_of_week.blank? } Select day
            - days = [ "Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday" ]
            - days.each_with_index do |day, index|
              %option{ value: index, selected: @list.payment_schedule.day_of_week == index }= day

        .space-y-2{ style: "display:none;", data: { effective_date_target: "monthOfYearField" } }
          %label.block.text-sm.font-semibold.text-gray-700{ for: "payment_schedule_month_of_year" }
            Month of year
            %span.text-red-500 *
          %input.w-full.rounded-md.border.border-gray-300.px-3.py-2.text-gray-900.shadow-sm.focus:border-gray-900.focus:ring-1.focus:ring-gray-900{ type: "number", name: "list[payment_schedule_attributes][month_of_year]", id: "payment_schedule_month_of_year", value: @list.payment_schedule.month_of_year }

        .space-y-2
          %label.block.text-sm.font-semibold.text-gray-700{ for: "payment_schedule_notification_lead_time" }
            Notify days before due
            %span.text-red-500 *
          %input.w-full.rounded-md.border.border-gray-300.px-3.py-2.text-gray-900.shadow-sm.focus:border-gray-900.focus:ring-1.focus:ring-gray-900{ type: "number", name: "list[payment_schedule_attributes][notification_lead_time]", id: "payment_schedule_notification_lead_time", value: @list.payment_schedule.notification_lead_time }
